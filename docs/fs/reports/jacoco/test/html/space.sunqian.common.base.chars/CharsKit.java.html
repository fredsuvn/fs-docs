<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CharsKit.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">fs-all</a> &gt; <a href="index.source.html" class="el_package">space.sunqian.common.base.chars</a> &gt; <span class="el_source">CharsKit.java</span></div><h1>CharsKit.java</h1><pre class="source lang-java linenums">package space.sunqian.common.base.chars;

import space.sunqian.annotations.Nonnull;
import space.sunqian.annotations.Nullable;
import space.sunqian.common.Fs;
import space.sunqian.common.base.system.SystemKeys;

import java.nio.CharBuffer;
import java.nio.charset.Charset;
import java.nio.charset.StandardCharsets;

/**
 * Utilities for {@code char}, {@code char array} and {@link Charset}.
 *
 * @author sunqian
 */
public class CharsKit {

    /**
     * Charset: UTF-8.
     */
<span class="fc" id="L22">    public static final @Nonnull Charset UTF_8 = StandardCharsets.UTF_8;</span>

    /**
     * Charset: ISO-8859-1.
     */
<span class="fc" id="L27">    public static final @Nonnull Charset ISO_8859_1 = StandardCharsets.ISO_8859_1;</span>

<span class="fc" id="L29">    private static final char @Nonnull [] EMPTY = {};</span>
<span class="fc" id="L30">    private static final @Nonnull CharBuffer EMPTY_BUFFER = CharBuffer.wrap(EMPTY);</span>

    /**
     * Returns whether the given buffer is null or empty.
     *
     * @param buffer the given buffer
     * @return whether the given buffer is null or empty
     */
    public static boolean isEmpty(@Nullable CharBuffer buffer) {
<span class="fc bfc" id="L39" title="All 4 branches covered.">        return buffer == null || !buffer.hasRemaining();</span>
    }

    /**
     * Returns an empty char array.
     *
     * @return an empty char array
     */
    public static char @Nonnull [] empty() {
<span class="fc" id="L48">        return EMPTY;</span>
    }

    /**
     * Returns an empty char buffer.
     *
     * @return an empty char buffer
     */
    public static @Nonnull CharBuffer emptyBuffer() {
<span class="fc" id="L57">        return EMPTY_BUFFER;</span>
    }

    /**
     * Returns the default charset: {@link #UTF_8}.
     *
     * @return the default charset: {@link #UTF_8}
     */
    public static @Nonnull Charset defaultCharset() {
<span class="fc" id="L66">        return UTF_8;</span>
    }

    /**
     * Returns the latin charset: {@link #ISO_8859_1}.
     *
     * @return the latin charset: {@link #ISO_8859_1}
     */
    public static @Nonnull Charset latinCharset() {
<span class="fc" id="L75">        return ISO_8859_1;</span>
    }

    /**
     * If the {@link #nativeCharset()} is not {@code null}, returns {@link #nativeCharset()}, otherwise returns
     * {@link #jvmCharset()}.
     *
     * @return if the {@link #nativeCharset()} is not {@code null}, returns {@link #nativeCharset()}, otherwise returns
     * {@link #jvmCharset()}.
     */
    public static @Nonnull Charset localCharset() {
<span class="fc" id="L86">        return Fs.nonnull(nativeCharset(), jvmCharset());</span>
    }

    /**
     * Returns the default charset of the JVM. It is equivalent to the {@link Charset#defaultCharset()}.
     *
     * @return the default charset of the JVM
     * @see Charset#defaultCharset()
     */
    public static @Nonnull Charset jvmCharset() {
<span class="fc" id="L96">        return Charset.defaultCharset();</span>
    }

    /**
     * Returns the charset from the host environment, which is typically the charset of current OS.
     * &lt;p&gt;
     * This method is &lt;b&gt;not&lt;/b&gt; equivalent to the {@link #jvmCharset()}, it will search the system properties in the
     * following order:
     * &lt;ul&gt;
     *     &lt;li&gt;native.encoding&lt;/li&gt;
     *     &lt;li&gt;sun.jnu.encoding&lt;/li&gt;
     *     &lt;li&gt;file.encoding&lt;/li&gt;
     * &lt;/ul&gt;
     * It may return {@code null} if not found.
     *
     * @return the charset from the host environment, which is typically the charset of current OS
     */
    public static @Nullable Charset nativeCharset() {
<span class="fc" id="L114">        return Natives.NATIVE_CHARSET;</span>
    }

    /**
     * Returns the charset with the specified name, may be {@code null} if searching fails.
     *
     * @param name the specified name
     * @return the charset with the specified name
     */
    public static @Nullable Charset charset(String name) {
        try {
<span class="fc" id="L125">            return Charset.forName(name);</span>
<span class="fc" id="L126">        } catch (Exception e) {</span>
<span class="fc" id="L127">            return null;</span>
        }
    }

    private static final class Natives {

<span class="fc" id="L133">        private static final @Nullable Charset NATIVE_CHARSET = searchNativeCharset();</span>

        private static @Nullable Charset searchNativeCharset() {
<span class="fc" id="L136">            return search(</span>
                SystemKeys.NATIVE_ENCODING,
                &quot;sun.jnu.encoding&quot;,
                SystemKeys.FILE_ENCODING
            );
        }

        private static @Nullable Charset search(String... proName) {
<span class="fc bfc" id="L144" title="All 2 branches covered.">            for (String s : proName) {</span>
<span class="fc" id="L145">                String prop = System.getProperty(s);</span>
<span class="fc" id="L146">                @Nullable Charset charset = charset(prop);</span>
<span class="fc bfc" id="L147" title="All 2 branches covered.">                if (charset != null) {</span>
<span class="fc" id="L148">                    return charset;</span>
                }
            }
<span class="fc" id="L151">            return null;</span>
        }
    }

    private CharsKit() {
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>