<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>UdpSender.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">fs-all</a> &gt; <a href="index.source.html" class="el_package">space.sunqian.common.net.udp</a> &gt; <span class="el_source">UdpSender.java</span></div><h1>UdpSender.java</h1><pre class="source lang-java linenums">package space.sunqian.common.net.udp;

import space.sunqian.annotations.Nonnull;
import space.sunqian.common.Fs;
import space.sunqian.common.base.chars.CharsKit;
import space.sunqian.common.net.NetException;

import java.net.DatagramPacket;
import java.net.InetAddress;
import java.net.InetSocketAddress;
import java.net.SocketAddress;
import java.nio.ByteBuffer;
import java.nio.channels.DatagramChannel;
import java.nio.charset.Charset;

/**
 * This interface is used to send UDP data.
 *
 * @author sunqian
 */
public interface UdpSender extends Cloneable {

    /**
     * Returns a new UDP sender which disables broadcast. This method is equivalent to {@code newSender(false)}.
     *
     * @return a new UDP sender
     * @throws NetException if an error occurs
     */
    static @Nonnull UdpSender newSender() throws NetException {
<span class="fc" id="L30">        return newSender(false);</span>
    }

    /**
     * Returns a new UDP sender. The parameter {@code broadcast} determines whether to enable broadcast, the broadcast
     * method can only be used when the {@code broadcast} is enabled.
     *
     * @param broadcast whether to enable broadcast
     * @return a new UDP sender
     * @throws NetException if an error occurs
     */
    static @Nonnull UdpSender newSender(boolean broadcast) throws NetException {
<span class="fc" id="L42">        return Fs.uncheck(() -&gt; UdpSenderBack.newSender(broadcast), NetException::new);</span>
    }

    /**
     * Sends buffer data to the specified address.
     *
     * @param data    the buffer data to be sent, its position will increment by the number of actual bytes sent
     * @param address the specified address to send to
     * @throws NetException if an error occurs
     */
    void sendData(@Nonnull ByteBuffer data, @Nonnull SocketAddress address) throws NetException;

    /**
     * Sends data to the specified address.
     *
     * @param data    the data to be sent
     * @param address the specified address to send to
     * @throws NetException if an error occurs
     */
    default void sendData(byte @Nonnull [] data, @Nonnull SocketAddress address) throws NetException {
<span class="fc" id="L62">        sendData(ByteBuffer.wrap(data), address);</span>
<span class="fc" id="L63">    }</span>

    /**
     * Sends data to the specified address. The string will be encoded using {@link CharsKit#defaultCharset()}.
     *
     * @param str     the string to be sent
     * @param address the specified address to send to
     * @throws NetException if an error occurs
     */
    default void sendString(@Nonnull String str, @Nonnull SocketAddress address) throws NetException {
<span class="fc" id="L73">        sendString(str, CharsKit.defaultCharset(), address);</span>
<span class="fc" id="L74">    }</span>

    /**
     * Sends string to the specified address. The string will be encoded using the specified charset.
     *
     * @param str     the string to be sent
     * @param charset the charset to encode the string
     * @param address the specified address to send to
     * @throws NetException if an error occurs
     */
    default void sendString(
        @Nonnull String str, @Nonnull Charset charset, @Nonnull SocketAddress address
    ) throws NetException {
<span class="fc" id="L87">        sendData(str.getBytes(charset), address);</span>
<span class="fc" id="L88">    }</span>

    /**
     * Sends the given datagram packet.
     *
     * @param packet the given datagram packet
     * @throws NetException if an error occurs
     */
    default void sendPacket(@Nonnull DatagramPacket packet) throws NetException {
<span class="fc" id="L97">        sendData(packet.getData(), packet.getSocketAddress());</span>
<span class="fc" id="L98">    }</span>

    /**
     * Sends a local broadcast, the content of the broadcast is the given byte buffer.
     *
     * @param data the given byte buffer to be sent, its position will increment by the number of actual bytes sent
     * @param port the port of the broadcast
     * @throws NetException if the broadcast is disabled, or an error occurs
     */
    default void sendBroadcast(@Nonnull ByteBuffer data, int port) throws NetException {
<span class="fc" id="L108">        sendData(data, new InetSocketAddress(broadcastAddress(), port));</span>
<span class="fc" id="L109">    }</span>

    /**
     * Sends a local broadcast, the content of the broadcast is the given byte array.
     *
     * @param data the given byte array to be sent
     * @param port the port of the broadcast
     * @throws NetException if the broadcast is disabled, or an error occurs
     */
    default void sendBroadcast(byte @Nonnull [] data, int port) throws NetException {
<span class="fc" id="L119">        sendBroadcast(ByteBuffer.wrap(data), port);</span>
<span class="fc" id="L120">    }</span>

    /**
     * Sends a local broadcast, the content of the broadcast is the given string. The string will be encoded using
     * {@link CharsKit#defaultCharset()}.
     *
     * @param str  the given string to be sent
     * @param port the port of the broadcast
     * @throws NetException if the broadcast is disabled, or an error occurs
     */
    default void sendBroadcast(@Nonnull String str, int port) throws NetException {
<span class="fc" id="L131">        sendBroadcast(str, CharsKit.defaultCharset(), port);</span>
<span class="fc" id="L132">    }</span>

    /**
     * Sends a local broadcast, the content of the broadcast is the given string. The string will be encoded using the
     * specified charset.
     *
     * @param str     the given string to be sent
     * @param charset the charset to encode the string
     * @param port    the port of the broadcast
     * @throws NetException if the broadcast is disabled, or an error occurs
     */
    default void sendBroadcast(@Nonnull String str, @Nonnull Charset charset, int port) throws NetException {
<span class="fc" id="L144">        sendBroadcast(str.getBytes(charset), port);</span>
<span class="fc" id="L145">    }</span>

    /**
     * Returns the broadcast address.
     *
     * @return the broadcast address
     * @throws NetException if the broadcast is disabled, or an error occurs
     */
    @Nonnull
    InetAddress broadcastAddress() throws NetException;

    /**
     * Refreshes and returns the broadcast address.
     *
     * @return the broadcast address
     * @throws NetException if the broadcast is disabled, or an error occurs
     */
    @Nonnull
    InetAddress refreshBroadcastAddress() throws NetException;

    /**
     * Closes this sender.
     *
     * @throws NetException if any error occurs
     */
    void close() throws NetException;

    /**
     * Returns the underlying channel that supports this sender.
     * &lt;p&gt;
     * This method is used to provide high-performance (such as direct buffer) data transmission support, and any
     * modifications to the underlying channel will affect the sender.
     *
     * @return the underlying channel that supports this sender
     */
    @Nonnull
    DatagramChannel channel();
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>